{% extends "base.html" %}

{%- macro contactFormItem(name, display, type, required) -%}
  <div class="form-group has-feedback" ng-class="{'has-error': errors.{{name}}}">
    <label for="{{name}}" class="control-label">{{display|capitalize}}</label>
    <input type="{{type}}" name="{{name}}" class="form-control" placeholder="Enter {{display}}" ng-model="contact.{{name}}" ng-model-options="{updateOn: 'blur'}" required>
    <span ng-show="errors.{{name}}" class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
    <div ng-show="errors.{{name}}" class="error pull-right">
      <div ng-show="form.{{name}}.$error.required">{{display|capitalize}} is required.</div>
      <div ng-show="form.{{name}}.$error.{{type}}">{{display|capitalize}} must be valid.</div>
    </div>
  </div>
{%- endmacro -%}

{% block scripts %}
  {% parent %}

  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
  <script src="js/contact-forms.js"></script>
{% endblock scripts %}


{% block contents %}
<div class="row">
	<div class="col-md-8">
		<h1>{{title}}</h1>
		{% if abstract %}<div class="mainBlurb">{{abstract}}</div>{% endif %}
	</div>

	{% block sidebarLeft %}
	{% endblock sidebarLeft %}
</div>

<div class="row">
  <div class="col-xs-12">
    {{contents|safe}}
  </div>
</div>

<div class="row">
  <div class="col-xs-12 col-sm-8 col-md-6">
    <div ng-app="ContactApp">
      <div ng-controller="ContactController">
        <form name="form" role="form" novalidate ng-cloak>
          {{contactFormItem("name", "name", "text", true)}}
          {{contactFormItem("email", "email address", "email", true)}}
          {{contactFormItem("phone", "phone number", "tel", true)}}
          {{contactFormItem("address", "address", "text", true)}}
          <button type="submit" class="btn btn-default" ng-click="update(contact)" ng-disabled="form.$invalid">Submit</button>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock contents %}
